!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"openDBData",value:function(){var e,t=window.indexedDB.open("restaurant",1);return t.onerror=function(e){alert("Database error:"+e.target.errorCode)},t.onsucess=function(t){e.event.target.result,console.log("IDB created!!!")},t.onupgradeneeded=function(t){console.log("Entered UPgrade!!!!!!!"),(e=t.target.result).createObjectStore("restaurant_name",{keyPath:"id"}).transaction.oncomplete=function(t){console.log("Entered objectstore!!!!!!!");var n=e.transaction(["restaurant_name"],"readwrite").objectStore("restaurant_name");n.length>0&&console.log("cached data ="+n.getAll())}},t}},{key:"getCachedData",value:function(e){e.onsucess=function(e){var t=e.target.result;if(t){console.log("Using IDB!!!!");var n=t.transaction(["restaurant_name"],"readonly").objectStore("restaurant_name");return console.log("IDB result "+n.getAll().result),n.getAll()}}}},{key:"fetchRestaurants",value:function(t){var n=e.openDBData();e.getCachedData(n),fetch(e.DATABASE_URL).then(function(e){return e.json()}).then(function(e){if(console.log(e),e.length>0){console.log("Upgrading!!!!!!");var a=n.result.transaction(["restaurant_name"],"readwrite").objectStore("restaurant_name");return e.forEach(function(e){a.add(e)}),console.log("objstore data"+a.getAll()),t(null,e)}}).catch(function(e){return alert("Request failed. Use cached data instead"),t(e,null)})}},{key:"fetchRestaurantById",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.find(function(e){return e.id==t});r?n(null,r):n("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.filter(function(e){return e.cuisine_type==t});n(null,r)}})}},{key:"fetchRestaurantByNeighborhood",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.filter(function(e){return e.neighborhood==t});n(null,r)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,n,a){e.fetchRestaurants(function(e,r){if(e)a(e,null);else{var o=r;"all"!=t&&(o=o.filter(function(e){return e.cuisine_type==t})),"all"!=n&&(o=o.filter(function(e){return e.neighborhood==n})),a(null,o)}})}},{key:"fetchNeighborhoods",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var a=n.map(function(e,t){return n[t].neighborhood}),r=a.filter(function(e,t){return a.indexOf(e)==t});t(null,r)}})}},{key:"fetchCuisines",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var a=n.map(function(e,t){return n[t].cuisine_type}),r=a.filter(function(e,t){return a.indexOf(e)==t});t(null,r)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"./img/"+e.id+".jpg"}},{key:"mapMarkerForRestaurant",value:function(t,n){return new google.maps.Marker({position:t.latlng,title:t.name,url:e.urlForRestaurant(t),map:n,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}}]),e}();t.default=r},function(e,t,n){"use strict";var a=function(e){return e&&e.__esModule?e:{default:e}}(n(0));document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=function(){a.default.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,t=document.getElementById("neighborhoods-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},fetchCuisines=function(){a.default.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.cuisines,t=document.getElementById("cuisines-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})},window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,u=t[r].value;a.default.fetchRestaurantByCuisineAndNeighborhood(o,u,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=document.createElement("img");n.className="restaurant-img",n.tabIndex="0",n.role="img",n.src=a.default.imageUrlForRestaurant(e),"./img/1.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Mission Chinese Food Restaurant, classical indoor decoration":"./img/2.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Emily Restaurant, Italian pizza":"./img/3.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Kang Ho Dong Baekjeong Restaurant, street food style decoration":"./img/4.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Katz's Delicatessen Restaurant, American fast food":"./img/5.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Roberta's Pizza Restaurant, classical Pizza decoration":"./img/6.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Hometown BBQ Restaurant, casual decoration":"./img/7.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Superiority Burger Restaurant, fast food style decoration":"./img/8.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="The Dutch Restaurant, classical indoor decoration":"./img/9.jpg"==a.default.imageUrlForRestaurant(e)?n.alt="Mu Ramen Restaurant, well-designed decoration":"./img/10.jpg"==a.default.imageUrlForRestaurant(e)&&(n.alt="Casa Enrique Restaurant, modern indoor decoration"),t.append(n);var r=document.createElement("h2");r.innerHTML=e.name,r.tabIndex="0",t.append(r);var o=document.createElement("p");o.innerHTML=e.neighborhood,t.append(o);var u=document.createElement("p");u.innerHTML=e.address,t.append(u);var i=document.createElement("a");return i.innerHTML="View Details",i.href=a.default.urlForRestaurant(e),t.append(i),t},addMarkersToMap=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=a.default.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})},e.exports={fetchNeighborhoods:fetchNeighborhoods,fillNeighborhoodsHTML:fillNeighborhoodsHTML,fetchCuisines:fetchCuisines,fillCuisinesHTML:fillCuisinesHTML,updateRestaurants:updateRestaurants,resetRestaurants:resetRestaurants,fillRestaurantsHTML:fillRestaurantsHTML,createRestaurantHTML:createRestaurantHTML,addMarkersToMap:addMarkersToMap}}]);
//# sourceMappingURL=main.js.map